"use strict";(self.webpackChunkflutter_rust_bridge=self.webpackChunkflutter_rust_bridge||[]).push([[8834],{3905:(t,e,r)=>{r.d(e,{Zo:()=>o,kt:()=>m});var a=r(67294);function n(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function i(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,a)}return r}function s(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?i(Object(r),!0).forEach((function(e){n(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function l(t,e){if(null==t)return{};var r,a,n=function(t,e){if(null==t)return{};var r,a,n={},i=Object.keys(t);for(a=0;a<i.length;a++)r=i[a],e.indexOf(r)>=0||(n[r]=t[r]);return n}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(a=0;a<i.length;a++)r=i[a],e.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}var u=a.createContext({}),p=function(t){var e=a.useContext(u),r=e;return t&&(r="function"==typeof t?t(e):s(s({},e),t)),r},o=function(t){var e=p(t.components);return a.createElement(u.Provider,{value:e},t.children)},c={inlineCode:"code",wrapper:function(t){var e=t.children;return a.createElement(a.Fragment,{},e)}},d=a.forwardRef((function(t,e){var r=t.components,n=t.mdxType,i=t.originalType,u=t.parentName,o=l(t,["components","mdxType","originalType","parentName"]),d=p(r),m=n,y=d["".concat(u,".").concat(m)]||d[m]||c[m]||i;return r?a.createElement(y,s(s({ref:e},o),{},{components:r})):a.createElement(y,s({ref:e},o))}));function m(t,e){var r=arguments,n=e&&e.mdxType;if("string"==typeof t||n){var i=r.length,s=new Array(i);s[0]=d;var l={};for(var u in e)hasOwnProperty.call(e,u)&&(l[u]=e[u]);l.originalType=t,l.mdxType="string"==typeof t?t:n,s[1]=l;for(var p=2;p<i;p++)s[p]=r[p];return a.createElement.apply(null,s)}return a.createElement.apply(null,r)}d.displayName="MDXCreateElement"},67418:(t,e,r)=>{r.r(e),r.d(e,{assets:()=>u,contentTitle:()=>s,default:()=>c,frontMatter:()=>i,metadata:()=>l,toc:()=>p});var a=r(87462),n=(r(67294),r(3905));const i={},s="Dart dynamic type",l={unversionedId:"guides/types/arbitrary/dart-dynamic",id:"guides/types/arbitrary/dart-dynamic",title:"Dart dynamic type",description:"Dart's dynamic is a special type that can hold any type of value. Although it is possible",source:"@site/docs/guides/types/arbitrary/dart-dynamic.md",sourceDirName:"guides/types/arbitrary",slug:"/guides/types/arbitrary/dart-dynamic",permalink:"/flutter_rust_bridge/guides/types/arbitrary/dart-dynamic",draft:!1,editUrl:"https://github.com/fzyzcjy/flutter_rust_bridge/tree/master/website/docs/guides/types/arbitrary/dart-dynamic.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Manual arbitrary Rust type",permalink:"/flutter_rust_bridge/guides/types/arbitrary/rust-opaque"},next:{title:"Two-way Road",permalink:"/flutter_rust_bridge/guides/direction/"}},u={},p=[{value:"Example",id:"example",level:2},{value:"Returning <code>dynamic</code>s",id:"returning-dynamics",level:2}],o={toc:p};function c(t){let{components:e,...r}=t;return(0,n.kt)("wrapper",(0,a.Z)({},o,r,{components:e,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"dart-dynamic-type"},"Dart dynamic type"),(0,n.kt)("p",null,"Dart's ",(0,n.kt)("inlineCode",{parentName:"p"},"dynamic")," is a special type that can hold any type of value. Although it is possible\nto return a ",(0,n.kt)("inlineCode",{parentName:"p"},"dynamic")," to Dart in the form of ",(0,n.kt)("a",{parentName:"p",href:"https://docs.rs/flutter_rust_bridge/latest/flutter_rust_bridge/ffi/type.DartDynamic.html"},(0,n.kt)("inlineCode",{parentName:"a"},"DartDynamic")),", it is preferable to\nreturn an ",(0,n.kt)("inlineCode",{parentName:"p"},"enum")," instead that has a variant for each type you want to support."),(0,n.kt)("h2",{id:"example"},"Example"),(0,n.kt)("p",null,"Let's say you have a struct that can hold either a ",(0,n.kt)("inlineCode",{parentName:"p"},"u32")," or a ",(0,n.kt)("inlineCode",{parentName:"p"},"String")," and some\nother fields (in a significantly worse design):"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-rust"},"struct MyStruct {\n    a: Optional<u32>,\n    b: Optional<String>,\n}\n\nstruct DataStruct {\n    msg:  String,\n    data: MyStruct,\n}\n")),(0,n.kt)("p",null,"You can define an ",(0,n.kt)("inlineCode",{parentName:"p"},"enum")," in Rust to represent this:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-rust"},"enum MyEnum {\n    U32(u32),\n    String(String),\n}\n")),(0,n.kt)("p",null,"And then you can define a struct that holds this ",(0,n.kt)("inlineCode",{parentName:"p"},"enum"),":"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-rust"},"struct MyStruct {\n    msg:  String,\n    data: MyEnum,\n}\n")),(0,n.kt)("h2",{id:"returning-dynamics"},"Returning ",(0,n.kt)("inlineCode",{parentName:"h2"},"dynamic"),"s"),(0,n.kt)("p",null,"Aside from ",(0,n.kt)("a",{parentName:"p",href:"./dart-opaque"},(0,n.kt)("inlineCode",{parentName:"a"},"DartOpaque")),", you may also return a ",(0,n.kt)("inlineCode",{parentName:"p"},"dynamic")," type to Dart by specifing the return type as ",(0,n.kt)("a",{parentName:"p",href:"https://docs.rs/flutter_rust_bridge/latest/flutter_rust_bridge/ffi/type.DartDynamic.html"},(0,n.kt)("inlineCode",{parentName:"a"},"DartDynamic")),".\n",(0,n.kt)("a",{parentName:"p",href:"https://docs.rs/flutter_rust_bridge/latest/flutter_rust_bridge/ffi/type.DartDynamic.html"},(0,n.kt)("inlineCode",{parentName:"a"},"DartDynamic"))," is the umbrella type for all ",(0,n.kt)("a",{parentName:"p",href:"https://docs.rs/flutter_rust_bridge/latest/flutter_rust_bridge/ffi/io/ffi/enum.DartCObjectType.html"},"C-representable"),"\nDart values, which can be obtained from Rust types that implement\n",(0,n.kt)("a",{parentName:"p",href:"https://docs.rs/flutter_rust_bridge/latest/flutter_rust_bridge/ffi/trait.IntoDart.html"},(0,n.kt)("inlineCode",{parentName:"a"},"IntoDart")),"."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-rust"},'pub fn return_dynamic() -> DartDynamic {\n    vec![\n        ().into_dart(),\n        0i32.into_dart(),\n        format!("Hello there!").into_dart()\n    ].into_dart()\n}\n')),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-dart"},'final dynamic values = await api.returnDynamic();\nassert(values is List<dynamic>);\nassert(values[0] == null);\nassert(values[1] == 0);\nassert(values[2] == "Hello there!");\n')),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://docs.rs/flutter_rust_bridge/latest/flutter_rust_bridge/ffi/type.DartDynamic.html"},(0,n.kt)("inlineCode",{parentName:"a"},"DartDynamic"))," is not supported as parameters, and structs that transitively include them may not be used in parameter positions either.\nIf you only care about accepting or returning an opaque Dart object without interacting with it, consider ",(0,n.kt)("a",{parentName:"p",href:"./dart-opaque"},(0,n.kt)("inlineCode",{parentName:"a"},"DartOpaque")),"."),(0,n.kt)("p",null,"This type is meant to be used only as an esacpe hatch, if your data cannot be expressed as either a fixed ",(0,n.kt)("a",{parentName:"p",href:"../translatable/detailed/struct"},"struct")," or ",(0,n.kt)("a",{parentName:"p",href:"../translatable/detailed/enum"},"enum"),"."))}c.isMDXComponent=!0}}]);